<!DOCTYPE html>
<html class="no-js">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Savory.js - Background tasks</title>
        <meta name="description" content="">
        <!-- <meta name="viewport" content="width=device-width"> -->

        <link rel="stylesheet" href="css/main.css">

        <script src="js/vendor/modernizr-2.8.3.min.js"></script>
        <script src="js/vendor/modernizr-2.8.3.min.js"></script><script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-62859778-1', 'auto');
          ga('send', 'pageview');

        </script>
    </head>
    <body>
        <header>
            <div class="wrapper">
                <nav>
                    <a href="index.html" title="Main page" id="logo">Savory.js <em><span class="version">version</span> 0.0.1-b</em></a>
                    <a class="active" href="getStarted.html" title="Get started">Get started</a>
                    <a class="download external" target="_blank" href="https://cdn.rawgit.com/mushtat/savory.js/master/savory.min.js" title="Downloads">Download</a>
                    <a class="external" target="_blank" href="https://github.com/mushtat/savory.js" title="Savory github">Github</a>
                </nav>
            </div>
        </header>
        <div role="main" id="container">
            <section class="wrapper content">
                <h1>Running background tasks</h1>
                <p>Very important notice: every script that will be loaded with a new page will be also executed and will appear in a single window scope. Nothing is cleared by default, so it is very important to use the scripts that prevent double self-initialization or simple scripts that run only once after loading.</p>
                <p> There is a simple music player without page reloading on this site. It serves just to demonstrate simple continious task execution while navigating. You can switch on the player by pressing "Play audio" button at the right bottom. The instructions and the example of the player embedded are available in <a href="player.html" title="">this example</a>.</p>
                <p>Every script loaded with a new page will be loaded forever, just to for you to know.</p>
                <p>Here is a simple timer code, that will run once and add clock to site footer. You can execute a following code by pressing <button id="timer">this button</button></p>
                <pre>&lt;script type=&quot;text/javascript&quot;&gt;
    !function(){
        var footer = document.getElementsByTagName('footer')[0],
            timerStartTrigger = document.getElementById('timer'),
            clockContainer = document.getElementById('clock');
        if (clockContainer) {
            return false;
        }
        timerStartTrigger.onclick = function(){
            clockContainer = document.createElement('span');
            clockContainer.id = 'clock';
            updateClock();
            window.setInterval(updateClock, 1000);
            footer.appendChild(clockContainer);
        };
        function updateClock() {
            var today = new Date(),
                h = checkDigits(today.getHours()),
                m = checkDigits(today.getMinutes()),
                s = checkDigits(today.getSeconds());
            function checkDigits(value) {
                if (value < 10) {
                    value = '0' + value;
                }
                return value;
            }
            clockContainer.innerHTML = h+':'+m+':'+s;
        }
    }();
&lt;/script&gt;</pre>
            </section>
        </div>
        <footer>
            <div class="wrapper">
                <span class="left"><span class="copyright">Copyright</span> 2013-2015 <span class="name">Dmitry Mushtat</span></span>
                <span class="right" id="audio">
                   <button class="button" id="audio-trigger">Play audio</button>
                </span>
                <span class="right">Savory.js</span>
            </div>
        </footer>
        <div id="scripts">
            <script type="text/javascript">
                !function(){
                    var footer = document.getElementsByTagName('footer')[0],
                        timerStartTrigger = document.getElementById('timer'),
                        clockContainer = document.getElementById('clock');
                    if (clockContainer) {
                        return false;
                    }
                    timerStartTrigger.onclick = function(){
                        clockContainer = document.createElement('span');
                        clockContainer.id = 'clock';
                        updateClock();
                        window.setInterval(updateClock, 1000);
                        footer.appendChild(clockContainer);
                        timerStartTrigger.onclick = null;
                    };
                    function updateClock() {
                        var today = new Date(),
                            h = checkDigits(today.getHours()),
                            m = checkDigits(today.getMinutes()),
                            s = checkDigits(today.getSeconds());
                        function checkDigits(value) {
                            if (value < 10) {
                                value = '0' + value;
                            }
                            return value;
                        }
                        clockContainer.innerHTML = h+':'+m+':'+s;
                    }
                }();
            </script>
            <script type="text/javascript">
                window.savoryConfig = {
                    callbacks : {
                        onReady : function(Savory){
                            Site.init();
                        },
                        onLoad : function(){
                            Site.init();
                        }
                    }
                }
            </script>
            <scriPt src="js/plugins.js"></script>
            <script src="js/main.js"></script>
            <script src="https://cdn.rawgit.com/mushtat/savory.js/master/savory.min.js"></script>
        </div>
    </body>
</html>