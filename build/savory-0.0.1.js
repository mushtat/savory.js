!function e(t,n,r){function o(a,s){if(!n[a]){if(!t[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(i)return i(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[a]={exports:{}};t[a][0].call(u.exports,function(e){var n=t[a][1][e];return o(n?n:e)},u,u.exports,e,t,n,r)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(e,t,n){!function(e,n,r){"undefined"!=typeof t&&t.exports?t.exports=r():"function"==typeof define&&define.amd?define(r):n[e]=r()}("bean",this,function(e,t){e=e||"bean",t=t||this;var n,r=window,o=t[e],i=/[^\.]*(?=\..*)\.|.*/,a=/\..*/,s="addEventListener",l="removeEventListener",c=document||{},u=c.documentElement||{},f=u[s],p=f?s:"attachEvent",h={},d=Array.prototype.slice,g=function(e,t){return e.split(t||" ")},v=function(e){return"string"==typeof e},m=function(e){return"function"==typeof e},y="click dblclick mouseup mousedown contextmenu mousewheel mousemultiwheel DOMMouseScroll mouseover mouseout mousemove selectstart selectend keydown keypress keyup orientationchange focus blur change reset select submit load unload beforeunload resize move DOMContentLoaded readystatechange message error abort scroll ",w="show input invalid touchstart touchmove touchend touchcancel gesturestart gesturechange gestureend textinput readystatechange pageshow pagehide popstate hashchange offline online afterprint beforeprint dragstart dragenter dragover dragleave drag drop dragend loadstart progress suspend emptied stalled loadmetadata loadeddata canplay canplaythrough playing waiting seeking seeked ended durationchange timeupdate play pause ratechange volumechange cuechange checking noupdate downloading cached updateready obsolete ",b=function(e,t,n){for(n=0;n<t.length;n++)t[n]&&(e[t[n]]=1);return e}({},g(y+(f?w:""))),_=function(){var e="compareDocumentPosition"in u?function(e,t){return t.compareDocumentPosition&&16===(16&t.compareDocumentPosition(e))}:"contains"in u?function(e,t){return t=9===t.nodeType||t===window?u:t,t!==e&&t.contains(e)}:function(e,t){for(;e=e.parentNode;)if(e===t)return 1;return 0},t=function(t){var n=t.relatedTarget;return n?n!==this&&"xul"!==n.prefix&&!/document/.test(this.toString())&&!e(n,this):null==n};return{mouseenter:{base:"mouseover",condition:t},mouseleave:{base:"mouseout",condition:t},mousewheel:{base:/Firefox/.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel"}}}(),E=function(){var e=g("altKey attrChange attrName bubbles cancelable ctrlKey currentTarget detail eventPhase getModifierState isTrusted metaKey relatedNode relatedTarget shiftKey srcElement target timeStamp type view which propertyName"),t=e.concat(g("button buttons clientX clientY dataTransfer fromElement offsetX offsetY pageX pageY screenX screenY toElement")),n=t.concat(g("wheelDelta wheelDeltaX wheelDeltaY wheelDeltaZ axis")),o=e.concat(g("char charCode key keyCode keyIdentifier keyLocation location")),i=e.concat(g("data")),a=e.concat(g("touches targetTouches changedTouches scale rotation")),s=e.concat(g("data origin source")),l=e.concat(g("state")),f=/over|out/,p=[{reg:/key/i,fix:function(e,t){return t.keyCode=e.keyCode||e.which,o}},{reg:/click|mouse(?!(.*wheel|scroll))|menu|drag|drop/i,fix:function(e,n,r){return n.rightClick=3===e.which||2===e.button,n.pos={x:0,y:0},e.pageX||e.pageY?(n.clientX=e.pageX,n.clientY=e.pageY):(e.clientX||e.clientY)&&(n.clientX=e.clientX+c.body.scrollLeft+u.scrollLeft,n.clientY=e.clientY+c.body.scrollTop+u.scrollTop),f.test(r)&&(n.relatedTarget=e.relatedTarget||e[("mouseover"==r?"from":"to")+"Element"]),t}},{reg:/mouse.*(wheel|scroll)/i,fix:function(){return n}},{reg:/^text/i,fix:function(){return i}},{reg:/^touch|^gesture/i,fix:function(){return a}},{reg:/^message$/i,fix:function(){return s}},{reg:/^popstate$/i,fix:function(){return l}},{reg:/.*/,fix:function(){return e}}],h={},d=function(e,t,n){if(arguments.length&&(e=e||((t.ownerDocument||t.document||t).parentWindow||r).event,this.originalEvent=e,this.isNative=n,this.isBean=!0,e)){var o,i,a,s,l,c=e.type,u=e.target||e.srcElement;if(this.target=u&&3===u.nodeType?u.parentNode:u,n){if(l=h[c],!l)for(o=0,i=p.length;i>o;o++)if(p[o].reg.test(c)){h[c]=l=p[o].fix;break}for(s=l(e,this,c),o=s.length;o--;)!((a=s[o])in this)&&a in e&&(this[a]=e[a])}}};return d.prototype.preventDefault=function(){this.originalEvent.preventDefault?this.originalEvent.preventDefault():this.originalEvent.returnValue=!1},d.prototype.stopPropagation=function(){this.originalEvent.stopPropagation?this.originalEvent.stopPropagation():this.originalEvent.cancelBubble=!0},d.prototype.stop=function(){this.preventDefault(),this.stopPropagation(),this.stopped=!0},d.prototype.stopImmediatePropagation=function(){this.originalEvent.stopImmediatePropagation&&this.originalEvent.stopImmediatePropagation(),this.isImmediatePropagationStopped=function(){return!0}},d.prototype.isImmediatePropagationStopped=function(){return this.originalEvent.isImmediatePropagationStopped&&this.originalEvent.isImmediatePropagationStopped()},d.prototype.clone=function(e){var t=new d(this,this.element,this.isNative);return t.currentTarget=e,t},d}(),x=function(e,t){return f||t||e!==c&&e!==r?e:u},k=function(){var e=function(e,t,n,r){var o=function(n,o){return t.apply(e,r?d.call(o,n?0:1).concat(r):o)},i=function(n,r){return t.__beanDel?t.__beanDel.ft(n.target,e):r},a=n?function(e){var t=i(e,this);return n.apply(t,arguments)?(e&&(e.currentTarget=t),o(e,arguments)):void 0}:function(e){return t.__beanDel&&(e=e.clone(i(e))),o(e,arguments)};return a.__beanDel=t.__beanDel,a},t=function(t,n,r,o,i,a,s){var l,c=_[n];"unload"==n&&(r=N(S,t,n,r,o)),c&&(c.condition&&(r=e(t,r,c.condition,a)),n=c.base||n),this.isNative=l=b[n]&&!!t[p],this.customType=!f&&!l&&n,this.element=t,this.type=n,this.original=o,this.namespaces=i,this.eventType=f||l?n:"propertychange",this.target=x(t,l),this[p]=!!this.target[p],this.root=s,this.handler=e(t,r,null,a)};return t.prototype.inNamespaces=function(e){var t,n,r=0;if(!e)return!0;if(!this.namespaces)return!1;for(t=e.length;t--;)for(n=this.namespaces.length;n--;)e[t]==this.namespaces[n]&&r++;return e.length===r},t.prototype.matches=function(e,t,n){return!(this.element!==e||t&&this.original!==t||n&&this.handler!==n)},t}(),T=function(){var e={},t=function(n,r,o,i,a,s){var l=a?"r":"$";if(r&&"*"!=r){var c,u=0,f=e[l+r],p="*"==n;if(!f)return;for(c=f.length;c>u;u++)if((p||f[u].matches(n,o,i))&&!s(f[u],f,u,r))return}else for(var h in e)h.charAt(0)==l&&t(n,h.substr(1),o,i,a,s)},n=function(t,n,r,o){var i,a=e[(o?"r":"$")+n];if(a)for(i=a.length;i--;)if(!a[i].root&&a[i].matches(t,r,null))return!0;return!1},r=function(e,n,r,o){var i=[];return t(e,n,r,null,o,function(e){return i.push(e)}),i},o=function(t){var n=!t.root&&!this.has(t.element,t.type,null,!1),r=(t.root?"r":"$")+t.type;return(e[r]||(e[r]=[])).push(t),n},i=function(n){t(n.element,n.type,null,n.handler,n.root,function(t,n,r){return n.splice(r,1),t.removed=!0,0===n.length&&delete e[(t.root?"r":"$")+t.type],!1})},a=function(){var t,n=[];for(t in e)"$"==t.charAt(0)&&(n=n.concat(e[t]));return n};return{has:n,get:r,put:o,del:i,entries:a}}(),j=function(e){n=arguments.length?e:c.querySelectorAll?function(e,t){return t.querySelectorAll(e)}:function(){throw new Error("Bean: No selector engine installed")}},L=function(e,t){if(f||!t||!e||e.propertyName=="_on"+t){var n=T.get(this,t||e.type,null,!1),r=n.length,o=0;for(e=new E(e,this,!0),t&&(e.type=t);r>o&&!e.isImmediatePropagationStopped();o++)n[o].removed||n[o].handler.call(this,e)}},C=f?function(e,t,n){e[n?s:l](t,L,!1)}:function(e,t,n,r){var o;n?(T.put(o=new k(e,r||t,function(t){L.call(e,t,r)},L,null,null,!0)),r&&null==e["_on"+r]&&(e["_on"+r]=0),o.target.attachEvent("on"+o.eventType,o.handler)):(o=T.get(e,r||t,L,!0)[0],o&&(o.target.detachEvent("on"+o.eventType,o.handler),T.del(o)))},N=function(e,t,n,r,o){return function(){r.apply(this,arguments),e(t,n,o)}},S=function(e,t,n,r){var o,i,s=t&&t.replace(a,""),l=T.get(e,s,null,!1),c={};for(o=0,i=l.length;i>o;o++)n&&l[o].original!==n||!l[o].inNamespaces(r)||(T.del(l[o]),!c[l[o].eventType]&&l[o][p]&&(c[l[o].eventType]={t:l[o].eventType,c:l[o].type}));for(o in c)T.has(e,c[o].t,null,!1)||C(e,c[o].t,!1,c[o].c)},P=function(e,t){var r=function(t,r){for(var o,i=v(e)?n(e,r):e;t&&t!==r;t=t.parentNode)for(o=i.length;o--;)if(i[o]===t)return t},o=function(e){var n=r(e.target,this);n&&t.apply(n,arguments)};return o.__beanDel={ft:r,selector:e},o},D=f?function(e,t,n){var o=c.createEvent(e?"HTMLEvents":"UIEvents");o[e?"initEvent":"initUIEvent"](t,!0,!0,r,1),n.dispatchEvent(o)}:function(e,t,n){n=x(n,e),e?n.fireEvent("on"+t,c.createEventObject()):n["_on"+t]++},O=function(e,t,n){var r,o,s,l,c=v(t);if(c&&t.indexOf(" ")>0){for(t=g(t),l=t.length;l--;)O(e,t[l],n);return e}if(o=c&&t.replace(a,""),o&&_[o]&&(o=_[o].base),!t||c)(s=c&&t.replace(i,""))&&(s=g(s,".")),S(e,o,n,s);else if(m(t))S(e,null,t);else for(r in t)t.hasOwnProperty(r)&&O(e,r,t[r]);return e},q=function(e,t,r,o){var s,l,c,u,f,v,y;{if(void 0!==r||"object"!=typeof t){for(m(r)?(f=d.call(arguments,3),o=s=r):(s=o,f=d.call(arguments,4),o=P(r,s,n)),c=g(t),this===h&&(o=N(O,e,t,o,s)),u=c.length;u--;)y=T.put(v=new k(e,c[u].replace(a,""),o,s,g(c[u].replace(i,""),"."),f,!1)),v[p]&&y&&C(e,v.eventType,!0,v.customType);return e}for(l in t)t.hasOwnProperty(l)&&q.call(this,e,l,t[l])}},I=function(e,t,n,r){return q.apply(null,v(n)?[e,n,t,r].concat(arguments.length>3?d.call(arguments,5):[]):d.call(arguments))},M=function(){return q.apply(h,arguments)},A=function(e,t,n){var r,o,s,l,c,u=g(t);for(r=u.length;r--;)if(t=u[r].replace(a,""),(l=u[r].replace(i,""))&&(l=g(l,".")),l||n||!e[p])for(c=T.get(e,t,null,!1),n=[!1].concat(n),o=0,s=c.length;s>o;o++)c[o].inNamespaces(l)&&c[o].handler.apply(e,n);else D(b[t],t,e);return e},R=function(e,t,n){for(var r,o,i=T.get(t,n,null,!1),a=i.length,s=0;a>s;s++)i[s].original&&(r=[e,i[s].type],(o=i[s].handler.__beanDel)&&r.push(o.selector),r.push(i[s].original),q.apply(null,r));return e},X={on:q,add:I,one:M,off:O,remove:O,clone:R,fire:A,Event:E,setSelectorEngine:j,noConflict:function(){return t[e]=o,this}};if(r.attachEvent){var $=function(){var e,t=T.entries();for(e in t)t[e].type&&"unload"!==t[e].type&&O(t[e].element,t[e].type);r.detachEvent("onunload",$),r.CollectGarbage&&r.CollectGarbage()};r.attachEvent("onunload",$)}return j(),X})},{}],2:[function(e,t,n){!function(e){if("function"==typeof define&&define.amd){var r="[history"+(new Date).getTime()+"]",o=requirejs.onError;e.toString=function(){return r},requirejs.onError=function(e){-1===e.message.indexOf(r)&&o.call(requirejs,e)},define([],e)}return"object"!=typeof n||"undefined"==typeof t?e():void(t.exports=e())}(function(){function e(){}function t(e,n,r){var o=/(?:(\w+\:))?(?:\/\/(?:[^@]*@)?([^\/:\?#]+)(?::([0-9]+))?)?([^\?#]*)(?:(\?[^#]+)|\?)?(?:(#.*))?/;if(null==e||""===e||n)e=n?e:E.href,(!L||r)&&(e=e.replace(/^[^#]*/,"")||"#",e=E.protocol.replace(/:.*$|$/,":")+"//"+E.host+R.basepath+e.replace(new RegExp("^#[/]?(?:"+R.type+")?"),""));else{var i=t(),a=y.getElementsByTagName("base")[0];!r&&a&&a.getAttribute("href")&&(a.href=a.href,i=t(a.href,null,!0));var s=i._pathname,l=i._protocol;e=""+e,e=/^(?:\w+\:)?\/\//.test(e)?0===e.indexOf("/")?l+e:e:l+"//"+i._host+(0===e.indexOf("/")?e:0===e.indexOf("?")?s+e:0===e.indexOf("#")?s+i._search+e:s.replace(/[^\/]+$/g,"")+e)}$.href=e;var c=o.exec($.href),u=c[2]+(c[3]?":"+c[3]:""),f=c[4]||"/",p=c[5]||"",h="#"===c[6]?"":c[6]||"",d=f+p+h,g=f.replace(new RegExp("^"+R.basepath,"i"),R.type)+p;return{_href:c[1]+"//"+u+d,_protocol:c[1],_host:u,_hostname:c[2],_port:c[3]||"",_pathname:f,_search:p,_hash:h,_relative:d,_nohash:g,_special:g+h}}function n(){var e;try{e=m.sessionStorage,e.setItem(X+"t","1"),e.removeItem(X+"t")}catch(t){e={getItem:function(e){var t=y.cookie.split(e+"=");return t.length>1&&t.pop().split(";").shift()||"null"},setItem:function(e,t){var n={};(n[E.href]=k.state)&&(y.cookie=e+"="+_.stringify(n))}}}try{U=_.parse(e.getItem(X))||{}}catch(t){U={}}I(P+"unload",function(){e.setItem(X,_.stringify(U))},!1)}function r(t,n,r,o){var i=0;r||(r={set:e},i=1);var a=!r.set,s=!r.get,l={configurable:!0,set:function(){a=1},get:function(){s=1}};try{N(t,n,l),t[n]=t[n],N(t,n,r)}catch(c){}if(!(a&&s||(t.__defineGetter__&&(t.__defineGetter__(n,l.get),t.__defineSetter__(n,l.set),t[n]=t[n],r.get&&t.__defineGetter__(n,r.get),r.set&&t.__defineSetter__(n,r.set)),a&&s))){if(i)return!1;if(t===m){try{var u=t[n];t[n]=null}catch(c){}if("execScript"in m)m.execScript("Public "+n,"VBScript"),m.execScript("var "+n+";","JavaScript");else try{N(t,n,{value:e})}catch(c){"onpopstate"===n&&(I("popstate",r=function(){M("popstate",r,!1);var e=t.onpopstate;t.onpopstate=null,setTimeout(function(){t.onpopstate=e},1)},!1),Y=0)}t[n]=u}else try{try{var f=b.create(t);N(b.getPrototypeOf(f)===t?f:t,n,r);for(var p in t)"function"==typeof t[p]&&(f[p]=t[p].bind(t));try{o.call(f,f,t)}catch(c){}t=f}catch(c){N(t.constructor.prototype,n,r)}}catch(c){return!1}}return t}function o(e,t,n){return n=n||{},e=e===Z?E:e,n.set=n.set||function(n){e[t]=n},n.get=n.get||function(){return e[t]},n}function i(e,t,n){e in V?V[e].push(t):arguments.length>3?I(e,t,n,arguments[3]):I(e,t,n)}function a(e,t,n){var r=V[e];if(r){for(var o=r.length;o--;)if(r[o]===t){r.splice(o,1);break}}else M(e,t,n)}function s(t,n){var o=(""+("string"==typeof t?t:t.type)).replace(/^on/,""),i=V[o];if(i){if(n="string"==typeof t?n:t,null==n.target)for(var a=["target","currentTarget","srcElement","type"];t=a.pop();)n=r(n,t,{get:"type"===t?function(){return o}:function(){return m}});Y&&(("popstate"===o?m.onpopstate:m.onhashchange)||e).call(m,n);for(var s=0,l=i.length;l>s;s++)i[s].call(m,n);return!0}return A(t,n)}function l(){var e=y.createEvent?y.createEvent("Event"):y.createEventObject();e.initEvent?e.initEvent("popstate",!1,!1):e.type="popstate",e.state=k.state,s(e)}function c(){B&&(B=!1,l())}function u(e,n,r,o){if(L)F=E.href;else{0===G&&(G=2);var i=t(n,2===G&&-1!==(""+n).indexOf("#"));i._relative!==t()._relative&&(F=o,r?E.replace("#"+i._special):E.hash=i._special)}!C&&e&&(U[E.href]=e),B=!1}function f(e){var n=F;if(F=E.href,n){H!==E.href&&l(),e=e||m.event;var r=t(n,!0),o=t();e.oldURL||(e.oldURL=r._href,e.newURL=o._href),r._hash!==o._hash&&s(e)}}function p(e){setTimeout(function(){I("popstate",function(e){H=E.href,C||(e=r(e,"state",{get:function(){return k.state}})),s(e)},!1)},0),!L&&e!==!0&&"location"in k&&(g(S.hash),c())}function h(e){for(;e;){if("A"===e.nodeName)return e;e=e.parentNode}}function d(e){var n=e||m.event,r=h(n.target||n.srcElement),o="defaultPrevented"in n?n.defaultPrevented:n.returnValue===!1;if(r&&"A"===r.nodeName&&!o){var i=t(),a=t(r.getAttribute("href",2)),s=i._href.split("#").shift()===a._href.split("#").shift();s&&a._hash&&(i._hash!==a._hash&&(S.hash=a._hash),g(a._hash),n.preventDefault?n.preventDefault():n.returnValue=!1)}}function g(e){var t=y.getElementById(e=(e||"").replace(/^#/,""));if(t&&t.id===e&&"A"===t.nodeName){var n=t.getBoundingClientRect();m.scrollTo(w.scrollLeft||0,n.top+(w.scrollTop||0)-(w.clientTop||0))}}function v(){var e=y.getElementsByTagName("script"),i=(e[e.length-1]||{}).src||"",a=-1!==i.indexOf("?")?i.split("?").pop():"";a.replace(/(\w+)(?:=([^&]*))?/g,function(e,t,n){R[t]=(n||"").replace(/^(0|false)$/,"")}),I(P+"hashchange",f,!1);var s=[Z,S,K,m,J,k];C&&delete J.state;for(var l=0;l<s.length;l+=2)for(var c in s[l])if(s[l].hasOwnProperty(c))if("function"==typeof s[l][c])s[l+1][c]=s[l][c];else{var u=o(s[l],c,s[l][c]);if(!r(s[l+1],c,u,function(e,t){t===k&&(m.history=k=s[l+1]=e)}))return M(P+"hashchange",f,!1),!1;s[l+1]===m&&(V[c]=V[c.substr(2)]=[])}return k.setup(),R.redirect&&k.redirect(),R.init&&(G=1),!C&&_&&n(),L||y[D](P+"click",d,!1),"complete"===y.readyState?p(!0):(L||t()._relative===R.basepath||(B=!0),I(P+"load",p,!1)),!0}var m=("object"==typeof window?window:this)||{};if(!m.history||"emulate"in m.history)return m.history;var y=m.document,w=y.documentElement,b=m.Object,_=m.JSON,E=m.location,x=m.history,k=x,T=x.pushState,j=x.replaceState,L=!!T,C="state"in x,N=b.defineProperty,S=r({},"t")?{}:y.createElement("a"),P="",D=m.addEventListener?"addEventListener":(P="on")&&"attachEvent",O=m.removeEventListener?"removeEventListener":"detachEvent",q=m.dispatchEvent?"dispatchEvent":"fireEvent",I=m[D],M=m[O],A=m[q],R={basepath:"/",redirect:0,type:"/",init:0},X="__historyAPI__",$=y.createElement("a"),F=E.href,H="",Y=1,B=!1,G=0,U={},V={},z=y.title,K={onhashchange:null,onpopstate:null},W=function(e,t){var n=m.history!==x;n&&(m.history=x),e.apply(x,t),n&&(m.history=k)},J={setup:function(e,t,n){R.basepath=(""+(null==e?R.basepath:e)).replace(/(?:^|\/)[^\/]*$/,"/"),R.type=null==t?R.type:t,R.redirect=null==n?R.redirect:!!n},redirect:function(e,n){if(k.setup(n,e),n=R.basepath,m.top==m.self){var r=t(null,!1,!0)._relative,o=E.pathname+E.search;L?(o=o.replace(/([^\/])$/,"$1/"),r!=n&&new RegExp("^"+n+"$","i").test(o)&&E.replace(r)):o!=n&&(o=o.replace(/([^\/])\?/,"$1/?"),new RegExp("^"+n,"i").test(o)&&E.replace(n+"#"+o.replace(new RegExp("^"+n,"i"),R.type)+E.hash))}},pushState:function(e,t,n){var r=y.title;null!=z&&(y.title=z),T&&W(T,arguments),u(e,n),y.title=r,z=t},replaceState:function(e,t,n){var r=y.title;null!=z&&(y.title=z),delete U[E.href],j&&W(j,arguments),u(e,n,!0),y.title=r,z=t},location:{set:function(e){0===G&&(G=1),m.location=e},get:function(){return 0===G&&(G=1),L?E:S}},state:{get:function(){return U[E.href]||null}}},Z={assign:function(e){0===(""+e).indexOf("#")?u(null,e):E.assign(e)},reload:function(){E.reload()},replace:function(e){0===(""+e).indexOf("#")?u(null,e,!0):E.replace(e)},toString:function(){return this.href},href:{get:function(){return t()._href}},protocol:null,host:null,hostname:null,port:null,pathname:{get:function(){return t()._pathname}},search:{get:function(){return t()._search}},hash:{set:function(e){u(null,(""+e).replace(/^(#|)/,"#"),!1,F)},get:function(){return t()._hash}}};return v()?(k.emulate=!L,m[D]=i,m[O]=a,m[q]=s,k):void 0})},{}],3:[function(e,t,n){(function(e){function t(){if(e.XMLHttpRequest)return new e.XMLHttpRequest;try{return new e.ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(t){}throw new Error("no xmlhttp request able to be created")}function r(e,t,n){e[t]=e[t]||n}n.ajax=function(e,n){"string"==typeof e&&(e={url:e});var o=e.headers||{},i=e.body,a=e.method||(i?"POST":"GET"),s=e.withCredentials||!1,l=t();l.onreadystatechange=function(){4==l.readyState&&n(l.status,l.responseText,l)},i&&(r(o,"X-Requested-With","XMLHttpRequest"),r(o,"Content-Type","application/x-www-form-urlencoded")),l.open(a,e.url,!0),l.withCredentials=s;for(var c in o)l.setRequestHeader(c,o[c]);l.send(i)}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],4:[function(e,t,n){"use strict";var r=e("./../plugins/utils.js"),o={container:"container",scriptsContainer:"scripts",autoInit:!0,updateScrollPosition:!0,links:{external:!1,identificatorClassName:"external",nav:{enabled:!1,list:["nav"],activeClassName:"active"}},error:{containerClassname:"savory-error"},request:{noCache:!0,requiredParam:!0,params:{savory:!0}},callbacks:{}},i=["onReady","onLoad"];window.savoryConfig?window.savoryConfig=r.merge(o,window.savoryConfig):window.savoryConfig=o;for(var a=0;a<i.length;a++)window.savoryConfig.callbacks[i[a]]||(window.savoryConfig.callbacks[i[a]]=function(){});t.exports=window.savoryConfig},{"./../plugins/utils.js":12}],5:[function(e,t,n){"use strict";var r=e("./../models/Parser.js"),o=e("./../models/Loader.js"),i=e("./../models/Evented.js"),a=e("./../models/Error.js"),s=e("./../config/savory.js"),l=e("./../plugins/utils.js");e("html5-history-api"),e("./../plugins/compat.js");var c=function(){function e(e,t){t&&"object"==typeof t||(t={}),t=l.merge({onSuccess:function(){},onError:function(){},onScriptsLoaded:function(){}},t),i.global.one("page.ready",t.onSuccess),i.global.one("page.load.error",t.onError),i.global.one("page.scripts.loaded",t.onScriptsLoaded),n.load(e)}var t=new a,n=new o,s=new r;this._={error:t,loader:n,parser:s,location:window.history.location||window.location},i.global.on("page.ready",this.onPageReady.bind(this)),i.global.on("link.clicked",this.onLinkClick.bind(this)),i.global.on("page.load.success",this.onLoad.bind(this)),i.global.on("page.load.error",this.onError.bind(this)),i.on(window,"popstate",this.onLocationChange.bind(this)),this._.loader.load(),this["public"]={load:e.bind(this)}};c.prototype.onPageReady=function(e){this._.parser.parse(),s.callbacks.onLoad()},c.prototype.onLinkClick=function(e){this.onLocationChange(e.href)},c.prototype.onLoad=function(e){this._.error.hide(),e.silent||history.pushState(e.path,null,e.path)},c.prototype.onError=function(e){console.log(e),this._.error.hide(),this._.error.show("Error loading "+e.path+" Error code: "+e.code)},c.prototype.onLocationChange=function(e){var t=!1;"string"!=typeof e&&(e=window.history.location.href,t=!0),this._.loader.load(e,{silent:t})},c.prototype.destroy=function(){i.global.off("page.ready"),i.global.off("link.clicked"),i.global.off("page.load.success"),i.global.off("page.load.error"),i.off(window,"popstate"),this._.error.destroy(),this._.loader.destroy(),this._.parser.destroy()},t.exports=c},{"./../config/savory.js":4,"./../models/Error.js":6,"./../models/Evented.js":7,"./../models/Loader.js":9,"./../models/Parser.js":10,"./../plugins/compat.js":11,"./../plugins/utils.js":12,"html5-history-api":2}],6:[function(e,t,n){"use strict";var r=e("./../config/savory.js"),o=function(){this.closeTimer=null,this.el=document.createElement("b"),this.el.classList.add(r.error.containerClassname),document.body.appendChild(this.el)};o.prototype.show=function(e){this.closeTimer&&clearTimeout(this.closeTimer),this.el.innerHTML=e||"Error occurred. ¯\\_(ツ)_/¯",this.el.setAttribute("style","position:fixed;z-index:999;left:0;top:0;padding:5px;background:#E44A4A;color:black;"),this.closeTimer=setTimeout(this.hide.bind(this),4e3)},o.prototype.hide=function(){this.el.innerHTML="",this.el.setAttribute("style","")},o.prototype.destroy=function(){this.closeTimer&&clearTimeout(this.closeTimer),delete this.closeTimer,this.el.parentNode&&this.el.parentNode.removeChild(this.el)},t.exports=o},{"./../config/savory.js":4}],7:[function(e,t,n){"use strict";function r(e){i.global[e]=function(t,n){o[e](a,t,n)}}var o=e("bean"),i=o,a=document.createElement("div"),s=["on","one","off","fire"];i.global={};for(var l=s.length-1;l>=0;l--)r(s[l]);t.exports=i},{bean:1}],8:[function(e,t,n){"use strict";var r=e("./Evented.js"),o=e("./../config/savory.js"),i=function(){};i.prototype.check=function(e){function t(t){var n="";if(o.links.nav.enabled)for(var i=0;i<o.links.nav.list.length;i++)if(e.classList.contains(o.links.nav.list[i])){n=o.links.nav.list[i],""!==this.target&&this.target||(r.global.fire("links.check",{navClassName:n}),e.classList.add(o.links.nav.activeClassName));break}return r.global.fire("link.clicked",{href:e.href,navClassName:n}),t&&t.preventDefault(),t}if(o.links.nav.enabled&&r.global.on("links.check",function(){e.classList.contains(o.links.nav.activeClassName)&&e.classList.remove(o.links.nav.activeClassName)}),e._savory)return!0;var n=!1,i=o.links.identificatorClassName;if((o.links.external&&e.classList.contains(i)||!o.links.external&&!e.classList.contains(i))&&(n=!0),n){if(0===e.getAttribute("href").length||"#"===e.getAttribute("href"))return!1;r.on(e,"click",t)}e._savory=!0},i.prototype.destroy=function(e){delete e._savory,r.off(e,"click"),r.on(e,"click",function(){return!0})},t.exports=i},{"./../config/savory.js":4,"./Evented.js":7}],9:[function(e,t,n){"use strict";var r=e("./Evented.js"),o=e("./../config/savory.js"),i=e("nanoajax"),a=e("./../plugins/utils.js"),s=function(){this._url=document.createElement("a"),this.scriptID="",this.currentFrameNode=null,this._scriptsProxy=document.createElement("div"),r.on(this,"page.load",this.onPageLoad.bind(this))};s.prototype.load=function(e,t){var n=document.querySelector("#"+o.container),s="";if(t=a.merge({silent:!1},t),!e)return r.global.fire("page.ready",{container:n,title:document.title}),!1;if(this._url.href=e,o.request.requiredParam)for(var l in o.request.params)s=l+"="+o.request.params[l];o.request.noCache&&(s.length>0&&(s+="&"),s+="ts="+(new Date).getTime()),"?"!==this._url.search&&s.length>0&&(s=this._url.search.length>0?"&"+s:"?"+s),i.ajax(e+s,function(n,o){var i={path:e,paramString:s,code:n,responseText:o,silent:t.silent};200===n?(r.global.fire("page.load.success",i),this.parse(o)):r.global.fire("page.load.error",i)}.bind(this))},s.prototype.parse=function(e){var t,n=this.normalizeHTML(e),o=document.createElement("iframe");o.src="about:blank",o.style.display="none",document.body.appendChild(o),t=o.contentDocument||o.contentWindow.document,o.contentWindow._savory=!0,o.onload=function(){this.onFrameLoad(o,n.scripts)}.bind(this),t.open("text/htmlreplace"),t.write(n.html),t.close(),this.currentFrameNode=o,r.one(this,"frame.clear",function(){this.currentFrameNode=null,document.body.removeChild(o)})},s.prototype.onFrameLoad=function(e,t){var n=e.contentDocument,i=n.querySelector("#"+o.container),s=n.title,l=[],c=function(e){var t=e.nodeValue;t.replace("<title>","").length!==t.length&&(t=t.replace("<title>",""),t=t.replace("</title>",""),s=t)};if(!s){l=a.findComments(n);for(var u=0;u<l.length;u++)c(l[u])}r.fire(this,"page.load",{container:i,title:s,scripts:t})},s.prototype.onPageLoad=function(e){function t(){function e(e){e.parentNode.removeChild(e)}var t=document.querySelectorAll(".savory_script");if(t&&t.length>0)for(var n=0;n<t.length;n++)e(t[n])}function n(e){function t(e,t){function n(){if(e.innerHTML.length>0){try{s=new Function(e.innerHTML),s.call(window)}catch(t){throw new Error(t,"Script executing error. Please, check your syntax")}a()}else l.onload=a,l.src=e.src||"",document.head.appendChild(l)}function a(){i++,l._loaded=!0,r.fire(l,"load.complete"),i===o.length&&r.global.fire("page.scripts.loaded")}var s,l=document.createElement("script");e.alias=l,l.id=e.id||"",l.className=e.className||"",l._loaded=!1,t&&t.alias._loaded===!1?r.one(t.alias,"load.complete",function(){n()}):n(),document.head.removeChild(e)}var n,o,i=0;for(this._scriptsProxy.innerHTML=e,n=this._scriptsProxy.childNodes,a=0;a<n.length;a++)1===n[a].nodeType&&document.head.appendChild(n[a]);o=document.head.querySelectorAll(".savory_"+this.scriptID);for(var a=0;a<o.length;a++)t(o[a],o[a-1])}var i=document.querySelector("#"+o.container);return i?(e.container&&(i.outerHTML=e.container.outerHTML),t(),e.scripts?n.call(this,e.scripts):r.global.fire("page.scripts.loaded"),o.updateScrollPosition&&window.scrollTo(0,0),document.title=e.title,r.global.fire("page.ready",i),void r.fire(this,"frame.clear")):(r.global.fire("page.load.error",{code:1,path:""}),!1)},s.prototype.normalizeHTML=function(e){var t={start:'<div id="'+o.scriptsContainer+'">',end:"</div>"},n=e.match(new RegExp("("+t.start+"((.|\n|\r)*)"+t.end+")")),r=function(){return Math.random().toString(36).substring(7)};if(n){var i=r();e=e.split(n[0]),e=e.join(""),n=n[0],n=n.split(t.start),n=n.join(""),n=n.split(t.end),n=n.join(""),n=n.replace(/<( .*|)script/gi,'<script class="savory_script savory_'+i+'" '),this.scriptID=i}return{html:e,scripts:n}},s.prototype.destroy=function(){r.off(this,"page.load"),r.off(this,"frame.clear"),this.currentFrameNode&&this.currentFrameNode.parentNode&&this.currentFrameNode.parentNode.removeChild(this.currentFrameNode)},t.exports=s},{"./../config/savory.js":4,"./../plugins/utils.js":12,"./Evented.js":7,nanoajax:3}],10:[function(e,t,n){"use strict";var r=e("./Link.js"),o=e("./Evented.js"),i=e("./../plugins/utils.js"),a=function(){};a.prototype.parse=function(){return this.dom={links:new r},o.global.off("links.check"),i.forEach(document.links,function(e,t){this.dom.links.check(t)},this),this.dom},a.prototype.destroy=function(){o.global.off("links.check"),i.forEach(document.links,function(e,t){this.dom.links.destroy(t)},this)},t.exports=a},{"./../plugins/utils.js":12,"./Evented.js":7,"./Link.js":8}],11:[function(e,t,n){"use strict";t.exports=function(){!function(){function e(e){this.el=e;for(var t=e.className.replace(/^\s+|\s+$/g,"").split(/\s+/),n=0;n<t.length;n++)r.call(this,t[n])}function t(e,t,n){Object.defineProperty?Object.defineProperty(e,t,{get:n}):e.__defineGetter__(t,n)}if(!("undefined"==typeof window.Element||"classList"in document.documentElement)){var n=Array.prototype,r=n.push,o=n.splice,i=n.join;e.prototype={add:function(e){this.contains(e)||(r.call(this,e),this.el.className=this.toString())},contains:function(e){return-1!=this.el.className.indexOf(e)},item:function(e){return this[e]||null},remove:function(e){if(this.contains(e)){for(var t=0;t<this.length&&this[t]!=e;t++);o.call(this,t,1),this.el.className=this.toString()}},toString:function(){return i.call(this," ")},toggle:function(e){return this.contains(e)?this.remove(e):this.add(e),this.contains(e)}},window.DOMTokenList=e,t(Element.prototype,"classList",function(){return new e(this)})}}(),Function.prototype.bind||(Function.prototype.bind=function(e){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),n=this,r=function(){},o=function(){return n.apply(this instanceof r?this:e,t.concat(Array.prototype.slice.call(arguments)))};return r.prototype=this.prototype,o.prototype=new r,o})}},{}],12:[function(e,t,n){"use strict";var r={merge:function(e,t){for(var n in t)try{t[n].constructor==Object?e[n]=r.merge(e[n],t[n]):e[n]=t[n]}catch(o){e[n]=t[n]}return e},forEach:function(e,t,n){if("function"!=typeof t)return!1;for(var r=0;r<e.length;r++)t.call(n,r,e[r])},findComments:function(e){for(var t=[],n=0;n<e.childNodes.length;n++){var r=e.childNodes[n];8===r.nodeType?t.push(r):t.push.apply(t,this.findComments(r))}return t}};t.exports=r},{}],13:[function(e,t,n){"use strict";!function(e,r){"object"==typeof n?t.exports=r():"function"==typeof define&&define.amd?define(["savory"],r):r()}(this,function(){function t(e){if(window._savory)return window._savory;var e=e||{};window.savoryConfig&&(e=r.merge(e,window.savoryConfig)),this.config=e,this["interface"]=new n,this.api=this["interface"]["public"],window.savoryConfig.callbacks.onReady(this),window._savory=this}var n=e("./controllers/Interface.js"),r=e("./plugins/utils.js");return t.prototype.destroy=function(){return this["interface"].destroy(),window._savory=null,delete window._savory,window.savory&&(window.savory=null,delete window.savory),null},window.Savory=t.bind(t),window.savoryConfig.autoInit&&(document.body?window.savory=new t:window.onload=function(){window.onload&&"function"==typeof window.onload&&window.onload(),window.savory=new t}),t})},{"./controllers/Interface.js":5,"./plugins/utils.js":12}]},{},[13]);
//# sourceMappingURL=savory-0.0.1.js.map